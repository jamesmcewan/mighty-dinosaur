---
import SectionHeadingBlock from "@/components/block/section-heading-block.astro"
import CategoryInline from "@/components/inline/category-inline.astro"
import getPosts from "@/data/get-posts"

const posts = await getPosts(5)
---

<section>
  <SectionHeadingBlock> Recent posts </SectionHeadingBlock>
  <ul class="grid gap-6">
    {
      posts.map((post) => {
        const { title, category, description, slug } = post.data;
        const titleWords = title.split(" ");
        const categoryWords = category ? category.split(" ") : [];
        return (
          <li>
            <a href={`/post/${slug}/`} class="block rounded-3xl">
              <h2 class="font-cartridgerough text-tn-orange/90 hover:text-tn-orange text-lg lg:text-xl transition-all duration-150 ease-in-out hover:brightness-110">
                {category && (
                  <CategoryInline>
                    {categoryWords.map((word, index) => (
                      <span
                        style={{
                          viewTransitionName: `category-${slug}-word-${index}`,
                        }}
                      >
                        {word}{index < categoryWords.length - 1 ? " " : ""}
                      </span>
                    ))}:
                  </CategoryInline>
                )}{" "}
                {titleWords.map((word, index) => (
                  <span
                    style={{
                      viewTransitionName: `title-${slug}-word-${index}`,
                    }}
                  >
                    {word}{index < titleWords.length - 1 ? " " : ""}
                  </span>
                ))}
              </h2>
              <p class="text-md lg:text-lg font-rethink text-tn-text">{description}</p>
            </a>
          </li>
        );
      })
    }
  </ul>
</section>
